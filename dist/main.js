!function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);class i{constructor(e=0,t=0,s=32,i,o){this.x=e,this.y=t,this.length=s,this.depth=i,this.sprite=null,this.shape=null,this.mouseover=!1,this.selected=!1,this.game=o,this.selectable=!0}update(){this.sprite&&this.sprite.update()}onMouseOver(){}onMouseLeave(){}onMouseClick(){}}class o{constructor(e,t){this.canvas=e,this.ctx=t,this.mouse={x:0,y:0},this.gameObjectStorage=[],this.gameObjectStorage[0]=[],this.gameObjectStorage[1]=[],this.gameObjectStorage[2]=[],this.gameObjectStorage[3]=[],this.selectedGameobject=null,document.onmousemove=this.updateMousePosition.bind(this),document.onclick=this.selectGameObject.bind(this);let s=this.update.bind(this);setInterval(s,20);this.methods={createGameObject:this.createGameObject.bind(this)}}createGameObject(e,t,s,i,o=3){let r=new e(t,s,i,o,this.methods);return this.gameObjectStorage[o].push(r),r}update(){this.gameObjectStorage.forEach((function(e){e.forEach((function(e){e.update()}))})),this.render()}updateMousePosition(e){this.mouse.x=e.clientX-this.canvas.getBoundingClientRect().x,this.mouse.y=e.clientY-this.canvas.getBoundingClientRect().y,this.isMouseOverGameObject()}isMouseOverGameObject(){let e=this.mouse.x,t=this.mouse.y;this.gameObjectStorage.forEach((function(s){s.forEach((function(s){let i=e-s.x<s.length&&e-s.x>0,o=t-s.y<s.length&&t-s.y>0;i&&o?(s.onMouseOver(),s.mouseover=!0):(s.onMouseLeave(),s.mouseover=!1)}))}))}selectGameObject(){let e=!1,t=null;for(let s=0;s<this.gameObjectStorage.length;s++)for(let i=0;i<this.gameObjectStorage[s].length;i++){let o=this.gameObjectStorage[s][i];o.selectable&&(o.selected&&(t=o),e?o.selected=!1:o.mouseover?(o.selected=!0,this.selectedGameobject=o,e=!0):o.selected=!1)}!e&&t&&(t.selected=!0)}render(){this.ctx.clearRect(0,0,400,400);for(let e=this.gameObjectStorage.length-1;e>=0;e--)for(let t=0;t<this.gameObjectStorage[e].length;t++){let s=this.gameObjectStorage[e][t];s.sprite&&this.ctx.drawImage(s.sprite.img,s.length*s.sprite.imageIndex,0,s.length,s.length,s.x,s.y,s.length,s.length),s.shape&&(this.ctx.fillStyle=s.shape.color,this.ctx.fillRect(s.x+s.shape.x,s.y+s.shape.y,s.shape.w,s.shape.h))}}}class r{constructor(e){this.img=e,this.imageIndex=0,this.frames=0,this.counter=0,this.maxCounter=0}update(){this.frames>1&&(this.counter++,this.counter>=this.maxCounter&&(this.imageIndex+=1,this.counter=0),this.imageIndex===this.frames&&(this.imageIndex=0))}}class n extends i{constructor(e=0,t=0,s=32,i){super(e,t,s,i),this.growCounter=0,this.growTime=0,this.isGrow=!1,this.selectable=!1,this.state={type:"",growth:!1,resource:""}}update(){this.isGrow||(this.growCounter++,this.shape={x:4,y:this.length-8,w:(this.length-8)*(this.growCounter/this.growTime),h:8,color:"red"},this.growCounter===this.growTime&&(this.isGrow=!0,this.growCompleted()))}growCompleted(){this.shape.color="green"}}class h extends n{constructor(e=0,t=0,s=32,i){super(e,t,s,i),this.growTime=100,this.sprite=new r(document.getElementById("spr-wheat"))}update(){super.update()}growCompleted(){super.growCompleted(),console.log("Wheat is grow")}}class a extends i{constructor(e=0,t=0,s=32,i,o){super(e,t,s,i,o),this.sprite=new r(document.getElementById("spr-grass")),this.sprite.frames=2,this.sprite.maxCounter=30+30*Math.random(),this.entity=null}onMouseOver(){this.shape={x:0,y:0,w:this.length,h:this.length,color:"rgba(255,255,255,0.3)"}}onMouseLeave(){this.shape=null}update(){super.update(),this.selected?this.shape={x:0,y:0,w:this.length,h:this.length,color:"rgba(255,255,255,0.2)"}:this.shape=null}placeWheat(){this.entity||(this.entity=this.game.createGameObject(h,this.x,this.y-12,50,0),console.log(this.entity.depth))}}window.onload=function(){let e=document.getElementById("main-canvas"),t=e.getContext("2d"),s=new o(e,t);for(let e=1;e<=8;e++)for(let t=1;t<=8;t++)s.createGameObject(a,50*e,50*t,50,3);document.getElementById("place-wheat").onclick=function(){s.selectedGameobject instanceof a&&s.selectedGameobject.placeWheat()}}}]);